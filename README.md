# Yandex-startups
**Отчет по исследованию**

**Цель данного исследования** - (1)разработать модель машинного обучения для предсказания продолжения деятельности стартапа, а так же (2)дать описание факторов влияющих на успешность старатапа.

Для решения поставленных задач были проанализированны данные, подобрана схема подготовки данных и обучена модель CatBoost с финальной метрикой F1=0,86. На основе модели проведен анализ важности признаков и сделаны рекомендации начинающим стартаперам.

**Этап предобработки данных:**

В ходе этапа изучения датасета выявлены множественные проблемы с качеством данных (пропуски данных, дубли в категориях, выбросы в числовых значениях, аномалии числовых значений).

Не обработанные множественные классы в признаках геогрфии и вида деятельности сами по себе усложняют машинное обучение и требуют специальных методов обработки текста.

**Разведочный анализ:**

  -  Категорийные поля имеют очень много значений - простое кодирование ohe не подойдет.

  -  Колонки funding_total_usd и funding_rounds содержат выбросы, которые так же есть и в тестовой выборке - пока не будем их удалять. Возможно провести категоризацию этих полей.

  -  Временные поля - потребуют создания признаков.

  -  Выявлен существенный дисбаланс целевой пременной (1 к 10).

  -  Выбросы числовых признаков присутствуют как в обучающей так и в тестовой выборках. Пока не будем их трогать.

  -  Выявлены аномалии дат: финасирование получено до создания фирмы.

  -  По столбцу category_list - ручная обработка признаков очень трудоемка. В качестве решения использованны 2 варианта: оставить первое значение из строки; укрупнение признаков.

  -  Корелляция показала значения свыше 95% для групп столбцов, что означает мультиколлениарность признаков.

  -  Были выявлены взаимосвязи как между признаками (финансирование - география - вид деятельности) так и с целевой переменной (срок деятельности, финасирование, раунды финансирования).

  -  По существу все группы признаков (финансирование, география и даты) имеют связь с целевой переменной, поэтому для обучения модели использовались разные подвыборки данных.

  -  Так же были добавлены новые синтетические признаки обрабатывающие даты и названия компаний.

**Этап обучения и выбора модели:**

Т.к. тестовый набор не включает целевой признак, то из обучающего наборы выделили валидационнюу и тестовую выборки.

В ходе сравнения базовых моделей(11шт.) на основе **pipeline sklearn** установлено, что наибольшим потенциалом для данного датасета обладают модели градиентного бустинга.

Были рассмотрены варианты кодирования и обработки:

    OHE vs TargetEncoder.
    SimpleImputer с фиксированным значением vs медианное значение.
    SimpleImputer vs KNNImputer vs IterativeImputer.
    Удаление всех пропусков.
    Понижение размерности: PCA.

Наиболее высокую метрику показали TargetEncoder + SimpleImputer.

На базе **pipeline imblearn** применена техника оверсемплинга SMOTENC (для датасетов с категориями) в сочетании с моделью LightGBM.

Наилучший результат показала тюнингованная модель CatBoost с метрикой **F1=0,86** (на Kaggle).

В качестве эксперимента были рассмотрены модели **стекинга**:

    SVM + MLP + RF + LGBM. Завершает LogRegr (F1 = 0.87).

    SVM + MLP + RF + LGBM. Завершает MLP.

    2 модели: США + неСША.

    2 модели: пропуски + НЕпропуски.

    Для отдельной модели по подвыборке "США" точность оказалась выше.

    Интересно, что для подвыборки с "пропусками" точность оказалась наивысшей, но не подтвердилась на тестовом наборе.

Окончательный выбор: модель CatBoost с оптимизацие Optuna.

**Анализ важности признаков модели:**

Наибольшая важность отмечена у признаков связанных со временем и датами. Чем дольше существует фирма, тем меньше вероятность закрытия. Опыт накапливается, квалификация персонала растет, формируется узнаваемый бренд, фирма расплачивается с кредитами, окупается и т.д.

Существенную роль играет величина финансирования. Как мы помним, по данному признаку было наибольшее кол-во пропущенных значений. Если удасться повысить качество данных по одной этой колонке, т.е. восполнить пробелы и устранить аномалии, то качество модели улучшится! Все таки, деньги решают.

Следующие по значимости признаки из серии отрасли и месторасположения бизнеса.

Таким образом мы можем составить факторы успешности стартапов (см. ниже).

**Факторы успешности стартапов (рекомендации):**

Имеющийся датасет позволяет выделить следующие группы факторов:

1. **Сфера деятельности фирмы**: статистику по выбранной отрасли следует изучить очень внимательно. Существуют более и менее популярные отрасли, напр. Biotechnology (а значит и более сложные для конкуренции, напр. Curated Web). Процент закрытия по видам деятельности распределен не равномерно и может подниматься свыше 30%, напр. Journalism. Есть области, где закрытых компаний нет, напр. Video (или пока нет). А так же сферы, где представлена всего 1 компания, напр. In-Flight Entertainment. Так же следует учесть, что популярность меняется со временем (подтверждается и матрицей корреляции), появляются новые направления и венчурный капитал устремляется туда. Кроме кол-ва самих предприятий по отраслям различаются и уровни их финансирования.
       - Среди самых успешных категорий выделяется IT направление, в том числе Big Data, автоматизация. Доля закрытых стартапов до 4 %.
       - Среди стартапов с неуказанной категорией доля закрытых составляет 30%.

2. **География**: выбор места реализации своего проекта так же влияет на успешность. В ряде стран, стартапов и в целом больше, и % закрытия там относительно меньше (напр. сравнить США-8% и Россия-35%). Отсутствующие значения по географии так же имеют высокую долю неудачных проектов - 20%. Факторами здесь являются местные особенности законодательства как в области регистрации так и инвестирования, льготы и поддержка, развитость инфраструктуры, внутрений спрос, развитость финансовых институтов, квалифицированные и доступные кадры, режимы налогооблажения, уровень бюрократии и коррупции, и проч.

3. С точки зрения инвестора - **время существования проекта и кол-во раундов финасирования** - являются показателями успешности. Начинающему стараперу следует учитывать это, так как наибольшее кол-во фирм закрывается в первые же годы. Следует тщательно готовить бизнес-план именно на первые несколько лет, предусмотреть действия на случай спада спроса/кризиса, а так же изучить опыт уже закрытых аналогичных стартапов в своей отрасли. Большинство стартапов имеют 1,2 раунда финансирования, но максимально может быть до 15-19. Более зрелый стартап в глазах инвестора выглядит более солидно и может расчитывать на большую сумму финасирования.

*Описаные группы не являются исчерпывающим и конечным списком факторов, а только отражают данные представленные в датасете.*



**Направления для дальнейшей работы:**

Учитывая слабое качество исходных данных, а также простейшую предобработку выполненую в настоящей работе, можно существенно продвинутся в исследовании повысив качество данных:

    Исправить пропуски.
    Устранить аномалии.
    Обработать категории.
    Добавить новые признаки - более характеризующие сам стартап, а не только его окружение.
    Добавить актульные данные по стартапам.
    Добавить мета-данные, например экономические кризисы в заданный год могут приводить к массовому закрытию стартапов.

Так же возможно продолжить и улучшение модели:

    Детально рассмотреть другие модели и методы ансамблирования.
    Использование более сложных моделей (например, нейросетей).
    Отбор признаков в данной работе осуществлялся вручную - возможно задейтсвовать специальные алгоритмы (напр., SelecktKBest).

**Развитие и развертывание данной модели как самостоятельного интернет-сервиса (стартап!?):**

Любой стартап может ввести свои данные и узнать рекомендации (что делать если ты стартапер). Инвестор при этом сможет увидеть наиболее выгодные/надежные фирмы в своем городе/стране/заданной местности, получить оценку по своему текущему инвест-портфелю, а так же и диверсифицировать свой портфель вложением в другие отрасли. Наша модель от этого будет пополнять данные и в итоге улучшать качество прогнозов.
